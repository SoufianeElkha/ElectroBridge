<!DOCTYPE html>
<html lang="it" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Preventivo & Targa Personalizzata — ElectroBridge</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --ink: #0B0F1A; --ink2: #2D3142; --accent: #1447E6;
      --muted: #717179; --bg: #FFFFFF; --surface: #F7F7F8; --border: #E4E4E8;
    }
    [data-theme="dark"] {
      --ink: #F0F2F8; --ink2: #C0C5D8; --accent: #5B8CFF;
      --muted: #8890A8; --bg: #0D1117; --surface: #151B27; --border: #222A3A;
    }
    html { scroll-behavior: smooth; }
    body { font-family: 'Inter', sans-serif; color: var(--ink); background: var(--bg); transition: background .3s, color .3s; }

    /* NAV */
    nav {
      background: rgba(255,255,255,0.92); backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border); padding: 0 56px; height: 64px;
      display: flex; align-items: center; justify-content: space-between;
      position: sticky; top: 0; z-index: 100;
      transition: background .3s;
    }
    [data-theme="dark"] nav { background: rgba(13,17,23,0.95); }
    .nav-logo { display: flex; align-items: center; gap: 10px; text-decoration: none; }
    .nav-wordmark { font-size: 17px; font-weight: 800; color: var(--ink); letter-spacing: -.5px; }
    .nav-wordmark span { color: var(--accent); }
    .nav-back { display: flex; align-items: center; gap: 6px; text-decoration: none; color: var(--muted); font-size: 13px; font-weight: 500; padding: 8px 14px; border-radius: 8px; border: 1px solid var(--border); transition: all .2s; }
    .nav-back:hover { color: var(--ink); border-color: var(--muted); }
    .nav-actions { display: flex; align-items: center; gap: 8px; }
    .dm-toggle { background: var(--surface); border: 1px solid var(--border); color: var(--muted); width: 36px; height: 36px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all .2s; }
    .dm-toggle:hover { color: var(--ink); }

    /* PAGE HEADER */
    .page-header { padding: 64px 56px 48px; max-width: 1180px; margin: 0 auto; }
    .page-header .eyebrow { font-size: 11px; font-weight: 700; color: var(--accent); letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 14px; display: block; }
    .page-header h1 { font-size: clamp(32px, 4vw, 52px); font-weight: 900; color: var(--ink); letter-spacing: -2px; line-height: 1.1; margin-bottom: 14px; }
    .page-header p { font-size: 16px; color: var(--muted); max-width: 560px; line-height: 1.7; }

    /* VERSION TOGGLE */
    .version-toggle { display: inline-flex; background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 4px; gap: 4px; margin-top: 28px; }
    .vtab { display: flex; align-items: center; gap: 8px; padding: 10px 20px; border: none; border-radius: 9px; font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 600; color: var(--muted); background: transparent; cursor: pointer; transition: all .2s; }
    .vtab.active { background: var(--bg); color: var(--ink); box-shadow: 0 1px 4px rgba(0,0,0,.08); }
    .vtab svg { flex-shrink: 0; }

    /* MAIN LAYOUT */
    .main-layout { max-width: 1180px; margin: 0 auto; padding: 0 56px 80px; display: grid; grid-template-columns: 1fr 420px; gap: 48px; align-items: start; }

    /* NAMEPLATE DESIGNER */
    .designer-card { background: var(--bg); border: 1px solid var(--border); border-radius: 20px; overflow: hidden; }
    .card-header { padding: 24px 28px; border-bottom: 1px solid var(--border); background: var(--surface); }
    .card-title { font-size: 16px; font-weight: 800; color: var(--ink); letter-spacing: -.5px; }
    .card-sub { font-size: 13px; color: var(--muted); margin-top: 4px; }
    .card-body { padding: 28px; }

    /* NAMEPLATE PREVIEW */
    .preview-wrap { background: #E8ECF0; border-radius: 12px; padding: 32px; display: flex; align-items: center; justify-content: center; margin-bottom: 28px; min-height: 200px; }
    .nameplate {
      width: 100%; max-width: 500px;
      background: #F5F5F0;
      border: 3px solid #C0C0B8;
      border-radius: 6px;
      padding: 16px 20px;
      display: grid;
      grid-template-columns: 80px 1fr;
      gap: 16px;
      align-items: center;
      box-shadow: 0 2px 8px rgba(0,0,0,.15), inset 0 1px 0 rgba(255,255,255,.5);
      font-family: 'Inter', sans-serif;
      position: relative;
    }
    .nameplate.color-silver { background: linear-gradient(135deg, #E8E8E8, #D0D0D0); border-color: #A0A0A0; }
    .nameplate.color-black { background: linear-gradient(135deg, #1a1a1a, #2a2a2a); border-color: #444; }
    .nameplate.color-blue { background: linear-gradient(135deg, #0D2144, #1a3560); border-color: #0a1a33; }

    .nameplate-logo-area {
      width: 80px; height: 80px;
      border: 1.5px dashed #bbb;
      border-radius: 4px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; transition: border-color .2s; overflow: hidden;
      background: rgba(255,255,255,.3);
      flex-shrink: 0;
    }
    .nameplate-logo-area:hover { border-color: var(--accent); }
    .nameplate-logo-area img { width: 100%; height: 100%; object-fit: contain; }
    .nameplate-logo-placeholder { font-size: 10px; color: #999; text-align: center; line-height: 1.4; padding: 8px; }

    .nameplate-info { display: flex; flex-direction: column; gap: 4px; }
    .np-line1 { font-size: 15px; font-weight: 800; color: #111; letter-spacing: -.3px; }
    .np-line2 { font-size: 11px; color: #444; font-weight: 500; }
    .np-line3 { font-size: 11px; color: #444; font-weight: 500; }
    .np-model { font-size: 10px; font-weight: 700; color: #1447E6; margin-top: 6px; letter-spacing: .3px; text-transform: uppercase; }
    .np-serial { font-size: 9px; color: #888; margin-top: 2px; }

    .nameplate.color-black .np-line1 { color: #fff; }
    .nameplate.color-black .np-line2 { color: rgba(255,255,255,.7); }
    .nameplate.color-black .np-line3 { color: rgba(255,255,255,.7); }
    .nameplate.color-black .np-model { color: #7ca2ff; }
    .nameplate.color-black .np-serial { color: rgba(255,255,255,.4); }
    .nameplate.color-black .nameplate-logo-area { border-color: rgba(255,255,255,.3); background: rgba(255,255,255,.1); }

    .nameplate.color-blue .np-line1 { color: #fff; }
    .nameplate.color-blue .np-line2 { color: rgba(255,255,255,.7); }
    .nameplate.color-blue .np-line3 { color: rgba(255,255,255,.7); }
    .nameplate.color-blue .np-model { color: #7ca2ff; }
    .nameplate.color-blue .np-serial { color: rgba(255,255,255,.4); }
    .nameplate.color-blue .nameplate-logo-area { border-color: rgba(255,255,255,.3); background: rgba(255,255,255,.1); }

    /* Corner screws on nameplate */
    .screw { position: absolute; width: 8px; height: 8px; border-radius: 50%; background: #A0A0A0; border: 1px solid #888; }
    .screw::after { content: ''; position: absolute; top: 50%; left: 50%; width: 60%; height: 1px; background: #666; transform: translate(-50%,-50%) rotate(45deg); }
    .screw.tl { top: 6px; left: 6px; }
    .screw.tr { top: 6px; right: 6px; }
    .screw.bl { bottom: 6px; left: 6px; }
    .screw.br { bottom: 6px; right: 6px; }
    .nameplate.color-black .screw { background: #444; border-color: #666; }
    .nameplate.color-black .screw::after { background: #888; }
    .nameplate.color-blue .screw { background: #1a3560; border-color: #3a5888; }
    .nameplate.color-blue .screw::after { background: #5a78a8; }

    /* CONTROLS */
    .controls-section { display: flex; flex-direction: column; gap: 16px; }
    .ctrl-label { font-size: 11px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px; display: block; }
    .ctrl-input { width: 100%; padding: 11px 14px; border: 1.5px solid var(--border); border-radius: 10px; font-family: 'Inter', sans-serif; font-size: 14px; color: var(--ink); background: var(--bg); outline: none; transition: border-color .2s; }
    .ctrl-input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(20,71,230,.07); }

    /* Color selector */
    .color-picker { display: flex; gap: 8px; }
    .color-opt { width: 32px; height: 32px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all .15s; position: relative; }
    .color-opt.active { border-color: var(--accent); transform: scale(1.1); box-shadow: 0 0 0 3px rgba(20,71,230,.15); }
    .color-opt.c-default { background: linear-gradient(135deg, #E8E8E0, #D0D0C8); }
    .color-opt.c-silver { background: linear-gradient(135deg, #E8E8E8, #C0C0C0); }
    .color-opt.c-black { background: linear-gradient(135deg, #1a1a1a, #333); }
    .color-opt.c-blue { background: linear-gradient(135deg, #0D2144, #1a3560); }

    /* Logo upload */
    .logo-drop { border: 1.5px dashed var(--border); border-radius: 10px; padding: 20px; text-align: center; cursor: pointer; transition: all .2s; background: var(--surface); }
    .logo-drop:hover { border-color: var(--accent); background: rgba(20,71,230,.03); }
    .logo-drop p { font-size: 13px; color: var(--muted); margin-top: 6px; }
    .logo-drop strong { font-size: 13px; color: var(--accent); }
    #logo-input { display: none; }

    /* RIGHT: form */
    .form-card { background: var(--bg); border: 1px solid var(--border); border-radius: 20px; overflow: hidden; position: sticky; top: 80px; }
    .form-card .card-header { padding: 24px 28px; border-bottom: 1px solid var(--border); background: var(--surface); }
    .form-card .card-body { padding: 28px; }
    .fg { margin-bottom: 14px; }
    .fg label { font-size: 11px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: .8px; margin-bottom: 6px; display: block; }
    .fg input, .fg textarea, .fg select {
      width: 100%; padding: 12px 14px; border: 1.5px solid var(--border); border-radius: 10px;
      font-family: 'Inter', sans-serif; font-size: 14px; color: var(--ink);
      background: var(--bg); outline: none; transition: border-color .2s; appearance: none;
    }
    .fg input:focus, .fg textarea:focus, .fg select:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(20,71,230,.07); }
    .fg textarea { height: 90px; resize: vertical; }
    .frow2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .targa-summary { background: var(--surface); border: 1px solid var(--border); border-radius: 10px; padding: 14px 16px; margin-bottom: 16px; }
    .targa-summary p { font-size: 12px; color: var(--muted); margin-bottom: 4px; }
    .targa-summary strong { font-size: 13px; color: var(--ink); }
    .btn-submit { width: 100%; padding: 15px; background: var(--ink); color: #fff; border: none; border-radius: 10px; font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 700; cursor: pointer; transition: background .2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .btn-submit:hover { background: var(--accent); }
    .privacy-note { font-size: 11px; color: var(--muted); text-align: center; margin-top: 12px; line-height: 1.5; }

    /* Senza targa: layout a colonna singola centrata */
    .main-layout.notarga { grid-template-columns: 1fr; max-width: 640px; }
    .main-layout.notarga .designer-card { display: none; }
    .main-layout.notarga .form-card { position: static; }
    @media (max-width: 900px) {
      nav { padding: 0 20px; }
      .page-header, .steps-bar, .main-layout { padding-left: 20px; padding-right: 20px; }
      .main-layout { grid-template-columns: 1fr; }
      .form-card { position: static; }
      .steps-bar { overflow-x: auto; }
    }
  </style>
</head>
<body>

<!-- NAV -->
<nav>
  <a href="PREVIEW_SITO_V2.html" class="nav-logo">
    <svg width="32" height="32" viewBox="0 0 36 36" fill="none">
      <rect width="36" height="36" rx="9" fill="var(--ink)"/>
      <line x1="9" y1="10" x2="9" y2="26" stroke="white" stroke-width="2" stroke-linecap="round"/>
      <line x1="9" y1="10" x2="16" y2="10" stroke="white" stroke-width="2" stroke-linecap="round"/>
      <line x1="9" y1="18" x2="15" y2="18" stroke="white" stroke-width="2" stroke-linecap="round"/>
      <line x1="9" y1="26" x2="16" y2="26" stroke="white" stroke-width="2" stroke-linecap="round"/>
      <line x1="20" y1="10" x2="20" y2="26" stroke="white" stroke-width="2" stroke-linecap="round"/>
      <path d="M20 10 Q28 10 28 14 Q28 18 20 18" stroke="white" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M20 18 Q29 18 29 22 Q29 26 20 26" stroke="white" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M22 8 L17 18 L21 18 L14 28" stroke="#1447E6" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <span class="nav-wordmark">Electro<span>Bridge</span></span>
  </a>
  <div class="nav-actions">
    <a href="PREVIEW_SITO_V2.html" class="nav-back">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none"><path d="M19 12H5M12 5l-7 7 7 7" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
      Torna al sito
    </a>
    <button class="dm-toggle" id="dm-toggle" title="Cambia tema" onclick="toggleDark()">
      <svg id="dm-icon" width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 12.79A9 9 0 1111.21 3a7 7 0 109.79 9.79z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
    </button>
  </div>
</nav>

<!-- PAGE HEADER -->
<div class="page-header">
  <span class="eyebrow">Configuratore Preventivo</span>
  <h1>Richiedi il tuo preventivo.</h1>
  <p>Scegli se vuoi includere una targa personalizzata con il tuo logo e i dati aziendali, oppure invia direttamente la richiesta tecnica.</p>

  <!-- VERSION TOGGLE -->
  <div class="version-toggle" id="version-toggle">
    <button class="vtab active" id="tab-targa" onclick="setVersion('targa')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><rect x="2" y="6" width="20" height="14" rx="3" stroke="currentColor" stroke-width="1.8"/><circle cx="7" cy="13" r="2" stroke="currentColor" stroke-width="1.5"/><line x1="12" y1="10" x2="20" y2="10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><line x1="12" y1="13" x2="20" y2="13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><line x1="12" y1="16" x2="17" y2="16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      Con Targa Personalizzata
    </button>
    <button class="vtab" id="tab-notarga" onclick="setVersion('notarga')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M9 12h6M9 16h4M14 3H6a2 2 0 00-2 2v14a2 2 0 002 2h12a2 2 0 002-2V8l-6-5z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
      Senza Targa — Solo Richiesta
    </button>
  </div>
</div>

<!-- MAIN LAYOUT -->
<div class="main-layout" id="main-layout">

  <!-- LEFT: Designer targa -->
  <div>
    <div class="designer-card">
      <div class="card-header">
        <div class="card-title">Designer Targa Personalizzata</div>
        <div class="card-sub">Modifica in tempo reale — la targa sar&#224; stampata e applicata al tuo quadro</div>
      </div>
      <div class="card-body">

        <!-- PREVIEW TARGA -->
        <div class="preview-wrap">
          <div class="nameplate color-default" id="nameplate">
            <div class="screw tl"></div>
            <div class="screw tr"></div>
            <div class="screw bl"></div>
            <div class="screw br"></div>
            <div class="nameplate-logo-area" id="logo-area" onclick="document.getElementById('logo-input').click()" title="Clicca per caricare il logo">
              <div class="nameplate-logo-placeholder" id="logo-placeholder">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" style="margin:0 auto 4px;display:block"><rect x="3" y="3" width="18" height="18" rx="3" stroke="#bbb" stroke-width="1.5"/><circle cx="8.5" cy="8.5" r="1.5" fill="#bbb"/><path d="M21 15l-5-5L5 21" stroke="#bbb" stroke-width="1.5" stroke-linecap="round"/></svg>
                Carica logo
              </div>
              <img id="logo-preview" src="" style="display:none" alt="Logo">
            </div>
            <div class="nameplate-info">
              <div class="np-line1" id="np-line1">Nome Azienda</div>
              <div class="np-line2" id="np-line2">Via Roma 1, 35100 Padova</div>
              <div class="np-line3" id="np-line3">Tel: +39 049 000 0000</div>
              <div class="np-model" id="np-model">DIRECTO-EN / 15 kW &nbsp;|&nbsp; EN 12845</div>
              <div class="np-serial">Matr. N&#176; _____________</div>
            </div>
          </div>
        </div>
        <input type="file" id="logo-input" accept="image/*">

        <!-- CONTROLS -->
        <div class="controls-section">

          <div>
            <span class="ctrl-label">Colore targa</span>
            <div class="color-picker">
              <div class="color-opt c-default active" title="Avorio / Alluminio" onclick="setColor('color-default', this)"></div>
              <div class="color-opt c-silver" title="Argento" onclick="setColor('color-silver', this)"></div>
              <div class="color-opt c-black" title="Nero" onclick="setColor('color-black', this)"></div>
              <div class="color-opt c-blue" title="Blu navy" onclick="setColor('color-blue', this)"></div>
            </div>
          </div>

          <div>
            <span class="ctrl-label">Logo aziendale</span>
            <div class="logo-drop" onclick="document.getElementById('logo-input').click()">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" style="margin:0 auto;display:block;color:var(--muted)"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
              <p><strong>Clicca per caricare</strong> oppure trascina il file qui</p>
              <p>PNG, JPG, SVG &mdash; max 5 MB</p>
            </div>
          </div>

          <div>
            <span class="ctrl-label">Riga 1 &mdash; Nome azienda</span>
            <input type="text" class="ctrl-input" id="in-line1" placeholder="Es. Rossi Impianti S.r.l." oninput="updateNP('np-line1','in-line1','Nome Azienda')">
          </div>

          <div>
            <span class="ctrl-label">Riga 2 &mdash; Indirizzo</span>
            <input type="text" class="ctrl-input" id="in-line2" placeholder="Es. Via Roma 1, 35100 Padova" oninput="updateNP('np-line2','in-line2','Via Roma 1, 35100 Padova')">
          </div>

          <div>
            <span class="ctrl-label">Riga 3 &mdash; Telefono / Email</span>
            <input type="text" class="ctrl-input" id="in-line3" placeholder="Es. Tel: +39 049 000 0000" oninput="updateNP('np-line3','in-line3','Tel: +39 049 000 0000')">
          </div>

          <div>
            <span class="ctrl-label">Modello quadro (per targa)</span>
            <select class="ctrl-input" id="in-model" onchange="updateModel()">
              <option value="DIRECTO-EN / 7,5 kW | EN 12845">Directo-EN / 7,5 kW</option>
              <option value="DIRECTO-EN / 15 kW | EN 12845" selected>Directo-EN / 15 kW</option>
              <option value="DIRECTO-EN / 22 kW | EN 12845">Directo-EN / 22 kW</option>
              <option value="STARDELTA-EN / 4-132 kW | EN 12845">Stardelta-EN / 4&ndash;132 kW</option>
              <option value="REACTO-EN / 4-132 kW | EN 12845">Reacto-EN / 4&ndash;132 kW</option>
              <option value="DIESEL-EN | EN 12845">Diesel-EN</option>
            </select>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- RIGHT: Form richiesta -->
  <div>
    <div class="form-card">
      <div class="card-header">
        <div class="card-title">Dati e Specifiche Tecniche</div>
        <div class="card-sub">Riceverai il preventivo entro 24 ore lavorative</div>
      </div>
      <div class="card-body">

        <!-- Riepilogo targa -->
        <div class="targa-summary">
          <p>&#9989; Targa configurata:</p>
          <strong id="summary-text">Directo-EN / 15 kW &mdash; Targa personalizzata</strong>
        </div>

        <div class="frow2">
          <div class="fg"><label>Nome *</label><input type="text" placeholder="Mario"></div>
          <div class="fg"><label>Cognome *</label><input type="text" placeholder="Rossi"></div>
        </div>
        <div class="fg"><label>Azienda</label><input type="text" placeholder="Rossi Impianti S.r.l."></div>
        <div class="frow2">
          <div class="fg"><label>Email *</label><input type="email" placeholder="mario@rossiimpianti.it"></div>
          <div class="fg"><label>Telefono</label><input type="tel" placeholder="+39 049 000 0000"></div>
        </div>
        <div class="fg">
          <label>Prodotto richiesto</label>
          <select id="form-model">
            <option>Directo-EN &mdash; Avviamento Diretto</option>
            <option>Stardelta-EN &mdash; Stella-Triangolo</option>
            <option>Reacto-EN &mdash; Avviamento ad Impedenza</option>
            <option>Diesel-EN &mdash; Motopompa Diesel</option>
            <option>Quadri Jockey / Accessori</option>
            <option>Altro / Personalizzato</option>
          </select>
        </div>
        <div class="fg">
          <label>Quantit&#224; e specifiche</label>
          <textarea placeholder="Es: 2x Directo-EN / 15 kW trifase, alimentazione 400V, con quadro jockey. Cantiere: Milano.&#10;Specifiche particolari o normative aggiuntive..."></textarea>
        </div>
        <button class="btn-submit">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Invia Richiesta con Targa
        </button>
        <p class="privacy-note">Risposta entro 24h lavorative. Nessun impegno, nessun intermediario.<br>I tuoi dati non vengono condivisi con terze parti.</p>
      </div>
    </div>
  </div>

</div><!-- end main-layout -->

<script>
  // Dark mode
  function toggleDark() {
    const html = document.documentElement;
    const isDark = html.getAttribute('data-theme') === 'dark';
    html.setAttribute('data-theme', isDark ? 'light' : 'dark');
    localStorage.setItem('eb-theme', isDark ? 'light' : 'dark');
    updateDMIcon(!isDark);
  }
  function updateDMIcon(dark) {
    const icon = document.getElementById('dm-icon');
    icon.innerHTML = dark
      ? '<circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="1.8"/><path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>'
      : '<path d="M21 12.79A9 9 0 1111.21 3a7 7 0 109.79 9.79z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>';
  }
  (function() {
    const saved = localStorage.getItem('eb-theme');
    if (saved === 'dark') { document.documentElement.setAttribute('data-theme','dark'); updateDMIcon(true); }
  })();

  // Nameplate live update
  function updateNP(elId, inputId, placeholder) {
    const val = document.getElementById(inputId).value.trim();
    document.getElementById(elId).textContent = val || placeholder;
    updateSummary();
  }
  function updateModel() {
    const val = document.getElementById('in-model').value;
    document.getElementById('np-model').textContent = val;
    updateSummary();
  }
  function updateSummary() {
    const model = document.getElementById('in-model').value;
    const azienda = document.getElementById('in-line1').value.trim() || 'Targa personalizzata';
    document.getElementById('summary-text').textContent = model + ' — ' + azienda;
  }

  // Color selector
  function setColor(colorClass, el) {
    const np = document.getElementById('nameplate');
    np.className = 'nameplate ' + colorClass;
    document.querySelectorAll('.color-opt').forEach(o => o.classList.remove('active'));
    el.classList.add('active');
  }

  // Logo upload
  document.getElementById('logo-input').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(ev) {
      const img = document.getElementById('logo-preview');
      const ph  = document.getElementById('logo-placeholder');
      img.src = ev.target.result;
      img.style.display = 'block';
      ph.style.display  = 'none';
    };
    reader.readAsDataURL(file);
  });

  // Version toggle: con targa / senza targa
  function setVersion(v) {
    const layout = document.getElementById('main-layout');
    const tabTarga   = document.getElementById('tab-targa');
    const tabNoTarga = document.getElementById('tab-notarga');
    if (v === 'targa') {
      layout.classList.remove('notarga');
      tabTarga.classList.add('active');
      tabNoTarga.classList.remove('active');
      document.querySelector('.targa-summary').style.display = '';
    } else {
      layout.classList.add('notarga');
      tabNoTarga.classList.add('active');
      tabTarga.classList.remove('active');
      document.querySelector('.targa-summary').style.display = 'none';
    }
  }

  // Drag & drop logo
  const dropZone = document.querySelector('.logo-drop');
  dropZone.addEventListener('dragover', e => { e.preventDefault(); dropZone.style.borderColor = 'var(--accent)'; });
  dropZone.addEventListener('dragleave', () => { dropZone.style.borderColor = ''; });
  dropZone.addEventListener('drop', e => {
    e.preventDefault(); dropZone.style.borderColor = '';
    const file = e.dataTransfer.files[0];
    if (!file || !file.type.startsWith('image/')) return;
    document.getElementById('logo-input').files = e.dataTransfer.files;
    const reader = new FileReader();
    reader.onload = ev => {
      document.getElementById('logo-preview').src = ev.target.result;
      document.getElementById('logo-preview').style.display = 'block';
      document.getElementById('logo-placeholder').style.display = 'none';
    };
    reader.readAsDataURL(file);
  });
</script>
</body>
</html>